{% extends "pets/pets_base.html" %}
{% block title %}Pet Logs{% endblock %}
{% block content %}
<div class="row">
    <div class="mycp col-lg-8 col-md-10 col-sm-12 mx-auto text-center bg-light py-3 mt-md-5 pb-5">    
        
        <h1>{{ pet.name }}'s' Log</h1>        
        <!-- <h2>Your Pets List</h2> -->
        {% if user.is_authenticated %}
        <p>{{ user.username }}'s Pets</p>
        <!-- <p>pet_id:{{ pet.id }}</p> -->
        {% endif %}
        <!-- <h4>{{ pet.name }}</h4> -->
        <p>Go Back to <a href="{% url 'pets' %}">All Your Pets List</a>.</p>
 
        <!-- <a href="{% url 'newpetlog' id=pet.id %}">Log a new Pet Action</a> -->

        {% if pet_log_list %}
        <table class="pet_list table table-striped table-hover table-bordered mt-4" id="myTable">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th onclick="sortTable(1)">Category</th>
                        <th onclick= "sortTable(2)" colspan="2">Action</th>
                        <th onclick= "sortTable(3)">Date</th>
                </tr>
                </thead>
                <tbody>
                    {% for obj in pet_log_list %}
                    <tr>
                        <td>{{ pet.name }}</td>
                        <td>{{ obj.category }}</td>
                        <td colspan="2">{{ obj.action }}</td>
                        <td>{{ obj.timestamp| date:'m/d/y' }}</td> <!-- 'm/d/y P' 'F j, Y, g:i a' -->
                        <!-- <td><a href=""><button >Edit</button></a></td> -->
                        <td><a href="{% url 'editpetlog' pk=obj.id id=pet.id %}"><button >Edit</button></a></td>
                        <td><a href="{% url 'deletepetlog' pk=obj.id id=pet.id %}"><button >Delete</button></a></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>No pet logs have been logged.</p>
            <p>Add a <a href="{% url 'newpetlog' id=pet.id %}">New Pet Log</a>.</p>
        {% endif %}
            <!-- <br><p>Go Back to <a href="{% url 'pets' %}">All Your Pets List</a>.</p> -->
            <a href="{% url 'newpetlog' id=pet.id %}">Log a new Pet Action</a>


  </div>
</div>
<!-- <script> src="{ % static 'js/myjs.js' % }"</script> -->
<!-- <script> src="../static/js/myjs.js"</script> -->
 <script>
function sortTable(n) {
  var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
  table = document.getElementById("myTable");
  switching = true;
  //Set the sorting direction to ascending:
  dir = "asc"; 
  /*Make a loop that will continue until
  no switching has been done:*/
  while (switching) {
    //start by saying: no switching is done:
    switching = false;
    rows = table.rows;
    /*Loop through all table rows (except the
    first, which contains table headers):*/
    for (i = 1; i < (rows.length - 1); i++) {
      //start by saying there should be no switching:
      shouldSwitch = false;
      /*Get the two elements you want to compare,
      one from current row and one from the next:*/
      x = rows[i].getElementsByTagName("TD")[n];
      y = rows[i + 1].getElementsByTagName("TD")[n];
      /*check if the two rows should switch place,
      based on the direction, asc or desc:*/
      if (dir == "asc") {
        if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
          //if so, mark as a switch and break the loop:
          shouldSwitch= true;
          break;
        }
      } else if (dir == "desc") {
        if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
          //if so, mark as a switch and break the loop:
          shouldSwitch = true;
          break;
        }
      }
    }
    if (shouldSwitch) {
      /*If a switch has been marked, make the switch
      and mark that a switch has been done:*/
      rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
      switching = true;
      //Each time a switch is done, increase this count by 1:
      switchcount ++;      
    } else {
      /*If no switching has been done AND the direction is "asc",
      set the direction to "desc" and run the while loop again.*/
      if (switchcount == 0 && dir == "asc") {
        dir = "desc";
        switching = true;
      }
    }
  }
}
</script>

{% endblock %}
